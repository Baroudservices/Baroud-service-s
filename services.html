<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Services - Baroud</title>

  <!-- Ù…Ù†Ø¹ Ø§Ù„ÙƒØ§Ø´ Ù‚Ø¯ Ù…Ø§ ÙÙŠÙ†Ø§ -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <style>
    body{
      font-family: system-ui, -apple-system, sans-serif;
      background:#0b1220;
      margin:0;
      padding:0;
      color:#fff;
    }
    .box{
      width:92%;
      max-width:420px;
      margin:40px auto;
      background:rgba(255,255,255,0.06);
      padding:22px;
      border-radius:22px;
      box-shadow: 0 18px 60px rgba(0,0,0,0.35);
      text-align:center;
      backdrop-filter: blur(10px);
    }
    h2{margin:10px 0 18px;font-size:30px;}
    button{
      width:100%;
      padding:16px;
      margin-top:12px;
      font-size:18px;
      border-radius:16px;
      border:none;
      cursor:pointer;
      background:rgba(255,255,255,0.12);
      color:#fff;
    }
    button:active{transform:scale(.99)}
    .small{opacity:.8;margin-top:12px;font-weight:600}

    /* Ø²Ø± + */
    #addCreditBtn{
      position:fixed;
      right:18px;
      bottom:18px;
      width:60px;
      height:60px;
      border-radius:50%;
      font-size:32px;
      font-weight:900;
      background:#111827;
      color:#fff;
      box-shadow: 0 10px 30px rgba(0,0,0,0.45);
      z-index:999;
    }
    /* Ø²Ø± ØªØ­Ø¯ÙŠØ« */
    #refreshBtn{
      position:fixed;
      left:18px;
      bottom:18px;
      width:60px;
      height:60px;
      border-radius:50%;
      font-size:22px;
      font-weight:900;
      background:#111827;
      color:#fff;
      box-shadow: 0 10px 30px rgba(0,0,0,0.45);
      z-index:999;
    }
    a{color:inherit;text-decoration:none}
  </style>
</head>

<body>

  <!-- Ø²Ø± ØªØ­Ø¯ÙŠØ« (Ø¨ÙŠÙƒØ³Ø± Ø§Ù„ÙƒØ§Ø´) -->
  <button id="refreshBtn" title="Refresh" onclick="hardRefresh()">â†»</button>

  <!-- Ø²Ø± Ø§Ø¶Ø§ÙØ© ÙƒØ±ÙŠØ¯Øª -->
  <button id="addCreditBtn" onclick="go('add-credit.html')">+</button>

  <div class="box">
    <h2>Baroud Services</h2>

    <div id="welcome">...</div>

    <a href="https://wa.me/96170385398" target="_blank" rel="noreferrer">
      <button type="button">WhatsApp</button>
    </a>

    <button type="button" onclick="alert('Service 1')">Service 1</button>
    <button type="button" onclick="alert('Service 2')">Service 2</button>

    <button type="button" onclick="logoutUser()">Logout</button>

    <div id="msg" class="small"></div>
  </div>

  <script>
    // âœ… Ø­Ø· Ø±Ø§Ø¨Ø· Ù…Ø´Ø±ÙˆØ¹Ùƒ Ù‡ÙˆÙ† (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±)
    const BASE = "https://udservices.github.io/Baroud-service-s/";

    const supabase = window.supabase.createClient(
      "https://pqrwitolonhfbfwtsnde.supabase.co",
      "sb_publishable_l5PtPu6xVyWq2pD6jzEYRw_CYEQ9-f_"
    );

    // âœ… ÙƒØ³Ø± ÙƒØ§Ø´ ØªÙ„Ù‚Ø§Ø¦ÙŠ: Ø£ÙˆÙ„ Ù…Ø§ ØªÙØªØ­ services.html Ø¥Ø°Ø§ Ù…Ø§ ÙÙŠ v Ø±Ø­ ÙŠØ¶ÙŠÙÙ‡Ø§ ÙˆÙŠØ¹Ù…Ù„ replace
    (function forceFresh() {
      const url = new URL(window.location.href);
      if (!url.searchParams.has("v")) {
        url.searchParams.set("v", Date.now().toString());
        window.location.replace(url.toString());
      }
    })();

    const welcomeEl = document.getElementById("welcome");
    const msgEl = document.getElementById("msg");

    async function guard() {
      const { data } = await supabase.auth.getSession();
      const user = data?.session?.user;
      if (!user) {
        // Ø±Ø¬Ù‘Ø¹ Ø¹Ù„Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø¹ ÙƒØ³Ø± ÙƒØ§Ø´
        window.location.replace(BASE + "index.html?v=" + Date.now());
        return;
      }
      welcomeEl.innerText = "Ø£Ù‡Ù„Ø§Ù‹ " + (user.email || "");
      msgEl.innerText = "Ready âœ…";
    }

    async function logoutUser() {
      await supabase.auth.signOut();
      window.location.replace(BASE + "index.html?v=" + Date.now());
    }

    // âœ… ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª Ù…Ø¹ v=timestamp Ø­ØªÙ‰ Ù…Ø§ ÙŠØ±Ø¬Ø¹Ù„Ùƒ Ù†Ø³Ø®Ø© Ù‚Ø¯ÙŠÙ…Ø©
    function go(page) {
      window.location.assign(BASE + page + "?v=" + Date.now());
    }

    // âœ… Ø²Ø± refresh Ø¬Ø°Ø±ÙŠ
    function hardRefresh() {
      // Ø¨ÙŠØºÙŠØ± v ÙˆÙŠØ¹Ù…Ù„ replace
      window.location.replace(BASE + "services.html?v=" + Date.now());
    }

    guard();
  <script>
/* ================================
   ğŸ” Auth & Navigation
================================ */

async function logoutUser() {
  await supabase.auth.signOut();
  window.location.replace(BASE + "index.html?v=" + Date.now());
}

// Ø­ØªÙ‰ Ù…Ø§ ÙŠØ±Ø¬Ø¹ Ù†Ø³Ø®Ø© Ù‚Ø¯ÙŠÙ…Ø© (cache busting)
function go(page) {
  window.location.assign(BASE + page + "?v=" + Date.now());
}

// Ø²Ø± refresh Ø¥Ø¬Ø¨Ø§Ø±ÙŠ
function hardRefresh() {
  window.location.replace(BASE + "services.html?v=" + Date.now());
}

guard();

/* ================================
   ğŸ”¥ Ø­Ø°Ù Service Worker ÙˆØ§Ù„ÙƒØ§Ø´ Ù†Ù‡Ø§Ø¦ÙŠÙ‹Ø§
================================ */

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.getRegistrations().then(function (registrations) {
    for (let registration of registrations) {
      registration.unregister();
    }
  });

  caches.keys().then(function (names) {
    for (let name of names) {
      caches.delete(name);
    }
  });
}
</script>

</body>
</html>
